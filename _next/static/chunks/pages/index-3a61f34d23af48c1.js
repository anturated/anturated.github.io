(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[332],{3874:()=>{},4177:(e,t,o)=>{"use strict";o.r(t),o.d(t,{api_url:()=>f,default:()=>m});var n=o(7876);o(3874);var s=o(4232),a=o(4718);let r=function(e){let{todos:t,dispatch:o}=e,r=(0,s.useContext)(f),i=async e=>{e.preventDefault();let n=e.currentTarget,s=n.todo.value,a=await fetch("".concat(r,"/api/todos"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:s})});if(a.ok){let e=await a.json();t.some(t=>t.id===e.id)||o({type:"edit",todo:{text:e.text,id:e.id,done:e.done}})}else console.error("failed to add todo");n.reset()};return(0,n.jsxs)("form",{className:"form",onSubmit:i,children:[(0,n.jsx)("label",{htmlFor:"todo",children:(0,n.jsx)("input",{type:"text",name:"todo",id:"todo",placeholder:"Попиши мені тута"})}),(0,n.jsxs)("button",{children:[(0,n.jsx)("span",{className:"visually-hidden",children:"Submit"}),(0,n.jsx)(a.A,{i:"add"})]})]})};var i=o(6446),l=o(6351),c=function(e){return e.SET="set",e.EDIT="edit",e.DELETE="delete",e}({}),d=function(e){return e[e.ERROR=0]="ERROR",e[e.CONNECTING=1]="CONNECTING",e[e.CONNECTING_LONG=2]="CONNECTING_LONG",e[e.CONNECTED=3]="CONNECTED",e}({});function u(e){let{item:t,dispatch:o,setSelectedTodo:r}=e,i=(0,s.useContext)(f),[l,d]=(0,s.useState)(!1),u=(0,s.useRef)(null),h=async()=>{(await fetch("".concat(i,"/api/todos"),{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:t.id})})).ok||console.error("error deleting")},x=async()=>{console.log("sending request to server"),(await fetch("".concat(i,"/api/todos"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...t,done:!t.done})})).ok?(console.log("response ok, dispatching"),o({type:c.EDIT,todo:{...t,done:!t.done}})):console.error("error checking")},N=async()=>{d(!0)};(0,s.useEffect)(()=>{l&&u.current&&(u.current.focus(),u.current.setSelectionRange(u.current.value.length,u.current.value.length))},[l]);let p=async()=>{let e=t.text,n=u.current.value;o({type:c.EDIT,todo:{...t,text:n}}),(await fetch("".concat(i,"/api/todos"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...t,text:n})})).ok||(console.error("error editing"),o({type:c.EDIT,todo:{...t,text:e}}))};return(0,n.jsx)("li",{id:null==t?void 0:t.id,className:"todo_item",children:l?(0,n.jsx)("form",{className:"edit-form",onSubmit:e=>{e.preventDefault(),d(!1),p()},children:(0,n.jsx)("label",{htmlFor:"edit-todo",children:(0,n.jsx)("input",{ref:u,type:"text",name:"edit-todo",id:"edit-todo",defaultValue:null==t?void 0:t.text,onBlur:()=>{d(!1),p()}})})}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("button",{className:"todo_items_left",onClick:x,children:(0,n.jsx)(a.A,{i:t.done?"check_box":"check_box_outline_blank"})}),(0,n.jsx)("p",{className:t.content?"has-content":"",onClick:()=>r(t),children:t.text}),(0,n.jsxs)("div",{className:"todo_items_right",children:[(0,n.jsxs)("button",{onClick:N,children:[(0,n.jsx)("span",{className:"visually-hidden",children:"Edit"}),(0,n.jsx)(a.A,{i:"edit"})]}),(0,n.jsxs)("button",{onClick:h,children:[(0,n.jsx)("span",{className:"visually-hidden",children:"Delete"}),(0,n.jsx)(a.A,{i:"delete"})]})]})]})})}let h=function(e){let{todos:t,dispatch:o,todoStatus:a,setSelectedTodo:r}=e,i=(0,s.useContext)(f);(0,s.useEffect)(()=>{let e;return(async function(){let e=await fetch("".concat(i,"/api/todos/negotiate"),{method:"POST",credentials:"omit"}).then(e=>e.json()).catch(()=>{throw Error("could not negotiate")}),t=new l.$().withUrl(e.Url,{accessTokenFactory:()=>e.AccessToken,withCredentials:!1}).withAutomaticReconnect().build();t.on("todoUpdated",e=>{o({type:c.EDIT,todo:e})}),t.on("todoDeleted",e=>{o({type:c.DELETE,todo:e})}),await t.start().catch(console.error)})().catch(e=>{console.error(e)}),()=>{e&&e.stop()}},[]);let h={[d.ERROR]:"Не загрузило :(",[d.CONNECTED]:"Якось порожньо",[d.CONNECTING]:"Гружусі",[d.CONNECTING_LONG]:"Мабуть сервак спить"};return(0,n.jsx)("ol",{className:"todo_list",children:t&&t.length>0?null==t?void 0:t.map((e,t)=>(0,n.jsx)(u,{item:e,dispatch:o,setSelectedTodo:r},t)):(0,n.jsx)("p",{children:h[a]})})},x=function(e){let{todo_completed:t,todo_total:o}=e;return(0,n.jsxs)("section",{className:"todo_banner",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text_large",children:"Цево"}),(0,n.jsx)("p",{className:"text_small",children:t==o&&0!==o?"Хороший хлопчик":"Давай там"})]}),(0,n.jsxs)("div",{children:[t,"/",o]})]})};function N(e,t){switch(t.type){case c.SET:return t.todos;case c.EDIT:if(!e.find(e=>e.id===t.todo.id))return[...e,t.todo];{let o=e.map(e=>e.id==t.todo.id?t.todo:e);return console.log(o.join(" ")),o}case c.DELETE:return e.filter(e=>e.id!==t.todo.id);default:throw Error("Unexpected action: "+t.type)}}function p(e){let{todo:t,dispatch:o,setSelectedTodo:r}=e,i=(0,s.useContext)(f),[l,c]=(0,s.useState)(t.content),d=async e=>{e&&await fetch("".concat(i,"/api/todos"),{method:"POST",body:JSON.stringify({...t,content:l}),headers:{"Content-Type":"application/json"}}),r(null)};return(0,n.jsx)("div",{className:"modal-overlay",children:(0,n.jsxs)("div",{className:"modal-content",children:[(0,n.jsx)("textarea",{placeholder:"Шооо тут можна писати",value:l,onChange:e=>c(e.currentTarget.value)}),(0,n.jsxs)("div",{className:"modal-buttons",children:[(0,n.jsx)("button",{onClick:()=>d(!0),children:(0,n.jsx)(a.A,{i:"save"})}),(0,n.jsx)("button",{onClick:()=>d(!1),children:(0,n.jsx)(a.A,{i:"close"})})]})]})})}function m(){let e=(0,s.useContext)(f),[t,o]=(0,s.useReducer)(N,[]),[a,l]=(0,s.useState)(d.CONNECTING),[u,m]=(0,s.useState)(null);return(0,s.useEffect)(()=>{fetch("".concat(e,"/api/todos")).then(e=>e.text()).then(e=>JSON.parse(e)).then(e=>o({type:c.SET,todos:e})).then(()=>l(d.CONNECTED)).catch(e=>{console.error("error fetching todods: "+e),l(d.ERROR),o({type:c.SET,todos:[{id:crypto.randomUUID.toString(),text:"сервак не загрузив",content:"",done:!1},{id:crypto.randomUUID.toString(),text:"на грайся поки з цим",content:"писанина",done:!1}]})}),setInterval(()=>{a==d.CONNECTING&&l(d.CONNECTING_LONG)},2e3)},[]),(0,n.jsxs)("div",{className:"App",children:[(0,n.jsx)(i.A,{}),(0,n.jsx)(x,{todo_completed:t.filter(e=>e.done).length,todo_total:t.length}),(0,n.jsx)(r,{todos:t,dispatch:o}),(0,n.jsx)(h,{todos:t,dispatch:o,todoStatus:a,setSelectedTodo:m}),u&&(0,n.jsx)(p,{todo:u,setSelectedTodo:m,dispatch:o})]})}let f=(0,s.createContext)("https://anturated-cnepggaggjegayfp.polandcentral-01.azurewebsites.net")},4718:(e,t,o)=>{"use strict";o.d(t,{A:()=>s});var n=o(7876);let s=function(e){let{i:t}=e;return(0,n.jsx)("span",{className:"material-symbols-outlined",children:t})}},6446:(e,t,o)=>{"use strict";o.d(t,{A:()=>r});var n=o(7876),s=o(8230),a=o.n(s);let r=function(){return(0,n.jsxs)("div",{className:"max-w-7xl mx-auto flex items-center justify-between outline-1 outline-amber-50",children:[(0,n.jsx)("h1",{className:"text-xl font-bold italic",children:"Booba"}),(0,n.jsxs)("nav",{className:"space-x-6",children:[(0,n.jsx)(a(),{href:"/",className:"hover:text-gray-300",children:"Home"}),(0,n.jsx)(a(),{href:"/",className:"hover:text-gray-300",children:"Notes"}),(0,n.jsx)(a(),{href:"/events",className:"hover:text-gray-300",children:"Events"}),(0,n.jsx)(a(),{href:"/warframe",className:"hover:text-gray-300",children:"Warframe"})]})]})}},6760:(e,t,o)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return o(4177)}])}},e=>{e.O(0,[230,351,636,593,792],()=>e(e.s=6760)),_N_E=e.O()}]);