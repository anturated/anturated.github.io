(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[536],{2796:(e,t,n)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/todo",function(){return n(7013)}])},4718:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var o=n(7876);n(7243);let s=function(e){let{i:t}=e;return(0,o.jsx)("span",{className:"material-symbols-outlined",children:t})}},6446:(e,t,n)=>{"use strict";n.d(t,{A:()=>l});var o=n(7876),s=n(8230),r=n.n(s);let l=function(){return(0,o.jsx)("div",{className:"min-w-screen flex justify-center",children:(0,o.jsxs)("div",{className:"header h-10 p-3 w-full max-w-6xl flex items-center justify-between outline-1 outline-amber-50",children:[(0,o.jsx)("h1",{className:"text-xl font-bold italic",children:"Booba"}),(0,o.jsxs)("nav",{className:"space-x-3",children:[(0,o.jsx)(r(),{href:"/",className:"hover:text-gray-300",children:"Home"}),(0,o.jsx)(r(),{href:"/todo",className:"hover:text-gray-300",children:"Notes"}),(0,o.jsx)(r(),{href:"/events",className:"hover:text-gray-300",children:"Events"}),(0,o.jsx)(r(),{href:"/warframe",className:"hover:text-gray-300",children:"Warframe"})]})]})})}},7013:(e,t,n)=>{"use strict";n.r(t),n.d(t,{api_url:()=>p,default:()=>N});var o=n(7876),s=n(4232),r=n(4718);let l=function(e){let{todos:t,dispatch:n}=e,l=(0,s.useContext)(p),c=async e=>{e.preventDefault();let o=e.currentTarget,s=o.todo.value,r=await fetch("".concat(l,"/api/todos"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:s})});if(r.ok){let e=await r.json();t.some(t=>t.id===e.id)||n({type:"edit",todo:{text:e.text,id:e.id,done:e.done}})}else console.error("failed to add todo");o.reset()};return(0,o.jsxs)("form",{className:"flex gap-3 w-full",onSubmit:c,children:[(0,o.jsx)("label",{className:"bg-surface-container p-3.5 rounded-2xl flex-1",htmlFor:"todo",children:(0,o.jsx)("input",{type:"text",name:"todo",id:"todo",placeholder:"Попиши мені тута"})}),(0,o.jsx)("button",{className:"bg-primary text-surface min-w-15 rounded-2xl flex items-center justify-center",children:(0,o.jsx)(r.A,{i:"add"})})]})};var c=n(6446),a=n(6351),i=function(e){return e.SET="set",e.EDIT="edit",e.DELETE="delete",e}({}),d=function(e){return e[e.ERROR=0]="ERROR",e[e.CONNECTING=1]="CONNECTING",e[e.CONNECTING_LONG=2]="CONNECTING_LONG",e[e.CONNECTED=3]="CONNECTED",e}({});function u(e){let{item:t,dispatch:n,setSelectedTodo:l}=e,c=(0,s.useContext)(p),[a,d]=(0,s.useState)(!1),u=(0,s.useRef)(null),x=async()=>{(await fetch("".concat(c,"/api/todos"),{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:t.id})})).ok||console.error("error deleting")},h=async()=>{console.log("sending request to server"),(await fetch("".concat(c,"/api/todos"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...t,done:!t.done})})).ok?(console.log("response ok, dispatching"),n({type:i.EDIT,todo:{...t,done:!t.done}})):console.error("error checking")},f=async()=>{d(!0)};(0,s.useEffect)(()=>{a&&u.current&&(u.current.focus(),u.current.setSelectionRange(u.current.value.length,u.current.value.length))},[a]);let m=async()=>{let e=t.text,o=u.current.value;n({type:i.EDIT,todo:{...t,text:o}}),(await fetch("".concat(c,"/api/todos"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...t,text:o})})).ok||(console.error("error editing"),n({type:i.EDIT,todo:{...t,text:e}}))},N=t.content?" italic":"";return(0,o.jsx)("li",{id:null==t?void 0:t.id,className:"bg-surface-container outline-1 outline-outline/50 rounded-2xl",children:(0,o.jsxs)("div",{className:"flex flex-row items-center justify-center p-3",children:[(0,o.jsx)("button",{className:"p-1 flex items-center justify-center",onClick:h,children:(0,o.jsx)(r.A,{i:t.done?"check_box":"check_box_outline_blank"})}),a?(0,o.jsx)("form",{className:"outline-0",onSubmit:e=>{e.preventDefault(),d(!1),m()},children:(0,o.jsx)("label",{htmlFor:"edit-todo",children:(0,o.jsx)("input",{ref:u,type:"text",name:"edit-todo",id:"edit-todo",defaultValue:null==t?void 0:t.text,onBlur:()=>{d(!1),m()}})})}):(0,o.jsx)("span",{className:"flex-1 text-center"+N,onClick:()=>l(t),children:t.text}),(0,o.jsxs)("div",{className:"flex flex-row gap-1 p-1",children:[(0,o.jsx)("button",{className:"flex items-center justify-center",onClick:f,children:(0,o.jsx)(r.A,{i:"edit"})}),(0,o.jsx)("button",{className:"flex items-center justify-center",onClick:x,children:(0,o.jsx)(r.A,{i:"delete"})})]})]})})}let x=function(e){let{todos:t,dispatch:n,todoStatus:r,setSelectedTodo:l}=e,c=(0,s.useContext)(p);(0,s.useEffect)(()=>{let e;return(async function(){let e=await fetch("".concat(c,"/api/todos/negotiate"),{method:"POST",credentials:"omit"}).then(e=>e.json()).catch(()=>{throw Error("could not negotiate")}),t=new a.$().withUrl(e.Url,{accessTokenFactory:()=>e.AccessToken,withCredentials:!1}).withAutomaticReconnect().build();t.on("todoUpdated",e=>{n({type:i.EDIT,todo:e})}),t.on("todoDeleted",e=>{n({type:i.DELETE,todo:e})}),await t.start().catch(console.error)})().catch(e=>{console.error(e)}),()=>{e&&e.stop()}},[]);let x={[d.ERROR]:"Не загрузило :(",[d.CONNECTED]:"Якось порожньо",[d.CONNECTING]:"Гружусі",[d.CONNECTING_LONG]:"Мабуть сервак спить"};return(0,o.jsx)("ol",{className:"w-full space-y-5",children:t&&t.length>0?null==t?void 0:t.map((e,t)=>(0,o.jsx)(u,{item:e,dispatch:n,setSelectedTodo:l},t)):(0,o.jsx)("p",{children:x[r]})})},h=function(e){let{todo_completed:t,todo_total:n}=e;return(0,o.jsxs)("div",{className:" grid items-center grid-cols-2 bg-surface-container-lowest rounded-2xl outline-outline outline-1 m-4 p-4",children:[(0,o.jsxs)("div",{className:"flex flex-col items-center gap-3",children:[(0,o.jsx)("span",{className:"text-4xl font-semibold",children:"Цево"}),(0,o.jsx)("span",{className:"italic",children:t==n&&0!==n?"Хороший хлопчик":"Давай там"})]}),(0,o.jsxs)("div",{className:"flex relative justify-center items-center",children:[(0,o.jsx)("svg",{className:"w-30 h-30",children:(0,o.jsx)("circle",{className:"text-surface-container-high",cx:"60",cy:"60",r:"55",fill:"currentColor"})}),(0,o.jsxs)("span",{className:"text-2xl absolute inset-0 flex justify-center items-center",children:[t,"/",n]})]})]})};function f(e,t){switch(t.type){case i.SET:return t.todos;case i.EDIT:if(!e.find(e=>e.id===t.todo.id))return[...e,t.todo];{let n=e.map(e=>e.id==t.todo.id?t.todo:e);return console.log(n.join(" ")),n}case i.DELETE:return e.filter(e=>e.id!==t.todo.id);default:throw Error("Unexpected action: "+t.type)}}function m(e){let{todo:t,dispatch:n,setSelectedTodo:l}=e,c=(0,s.useContext)(p),[a,i]=(0,s.useState)(t.content),d=async e=>{e&&await fetch("".concat(c,"/api/todos"),{method:"POST",body:JSON.stringify({...t,content:a}),headers:{"Content-Type":"application/json"}}),l(null)};return(0,o.jsx)("div",{className:"min-h-screen min-w-screen bg-surface-container/50 fixed top-0 left-0 flex items-center justify-center",children:(0,o.jsxs)("div",{className:"relative bg-surface-container-lowest shadow-shadow shadow rounded-2xl p-3 flex flex-col",children:[(0,o.jsx)("textarea",{className:"resize-none min-h-70 min-w-85 md:min-w-xl",placeholder:"Шооо тут можна писати",value:a,onChange:e=>i(e.currentTarget.value)}),(0,o.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,o.jsx)("button",{className:"hover:text-tertiary",onClick:()=>d(!0),children:(0,o.jsx)(r.A,{i:"save"})}),(0,o.jsx)("button",{className:"hover:text-error",onClick:()=>d(!1),children:(0,o.jsx)(r.A,{i:"close"})})]})]})})}function N(){let e=(0,s.useContext)(p),[t,n]=(0,s.useReducer)(f,[]),[r,a]=(0,s.useState)(d.CONNECTING),[u,N]=(0,s.useState)(null);return(0,s.useEffect)(()=>{fetch("".concat(e,"/api/todos")).then(e=>e.text()).then(e=>JSON.parse(e)).then(e=>n({type:i.SET,todos:e})).then(()=>a(d.CONNECTED)).catch(e=>{console.error("error fetching todods: "+e),a(d.ERROR),n({type:i.SET,todos:[{id:crypto.randomUUID.toString(),text:"сервак не загрузив",content:"",done:!1},{id:crypto.randomUUID.toString(),text:"на грайся поки з цим",content:"писанина",done:!1}]})}),setInterval(()=>{r==d.CONNECTING&&a(d.CONNECTING_LONG)},2e3)},[]),(0,o.jsxs)("div",{className:"min-h-screen md:flex md:flex-col",children:[(0,o.jsx)(c.A,{}),(0,o.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 items-center flex-1",children:[(0,o.jsx)(h,{todo_completed:t.filter(e=>e.done).length,todo_total:t.length}),(0,o.jsxs)("div",{className:"flex flex-col items-start h-full p-5 gap-5",children:[(0,o.jsx)(l,{todos:t,dispatch:n}),(0,o.jsx)(x,{todos:t,dispatch:n,todoStatus:r,setSelectedTodo:N}),u&&(0,o.jsx)(m,{todo:u,setSelectedTodo:N,dispatch:n})]})]})]})}let p=(0,s.createContext)("https://anturated-cnepggaggjegayfp.polandcentral-01.azurewebsites.net")}},e=>{e.O(0,[230,245,636,593,792],()=>e(e.s=2796)),_N_E=e.O()}]);